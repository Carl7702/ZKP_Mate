# 📊 时间戳统计面板功能

## 功能概述

TimeLock 应用新增了实时统计面板功能，为用户提供合约使用情况的详细数据洞察。

## 🎯 主要功能

### 1. 合约统计面板
- **总哈希值数量**: 显示已上链的哈希值总数
- **总交易量**: 显示合约的总交易金额
- **最后更新时间**: 显示最后一次上链操作的时间
- **当前网络**: 显示当前连接的网络信息

### 2. 实时价格图表
- **当前价格**: 显示每字节的实时价格
- **价格变化**: 显示价格相对于上次更新的变化百分比
- **价格趋势**: 可视化显示最近10个价格数据点的趋势
- **自动更新**: 每60秒自动更新价格数据

## 🔧 技术实现

### 智能合约增强
在 `contract/src/lib.rs` 中添加了统计相关字段：
```rust
pub struct StampingContract {
    // ... 现有字段
    total_hashes: u64,        // 总哈希值数量
    total_volume: Balance,    // 总交易量
    last_updated: u64,        // 最后更新时间
}
```

新增合约方法：
- `get_stats()`: 获取完整统计信息
- `get_total_hashes()`: 获取总哈希值数量
- `get_total_volume()`: 获取总交易量
- `get_last_updated()`: 获取最后更新时间

### 前端组件
1. **StatsPanel.tsx**: 主统计面板组件
   - 显示合约统计数据
   - 自动刷新功能（每30秒）
   - 错误处理和加载状态

2. **PriceChart.tsx**: 价格图表组件
   - 实时价格显示
   - 价格变化指示器
   - 趋势图表可视化

### 合约服务增强
在 `contract.ts` 中添加了 `getContractStats()` 方法：
```typescript
public async getContractStats(): Promise<{
  totalHashes: number;
  totalVolume: bigint;
  lastUpdated: number;
}>
```

## 🎨 界面设计

### 统计卡片
- 使用毛玻璃效果背景
- 悬停动画效果
- 响应式网格布局
- 图标和数值的清晰展示

### 价格图表
- 实时价格大字体显示
- 涨跌颜色指示器（绿色/红色）
- 迷你趋势图表
- 悬停显示详细信息

## 📱 响应式设计

- 桌面端：4列网格布局
- 平板端：2列网格布局
- 移动端：单列布局，优化触摸体验

## 🔄 自动更新机制

- 统计数据：每30秒自动刷新
- 价格数据：每60秒自动更新
- 手动刷新：点击刷新按钮立即更新

## 🧪 测试模式支持

在测试模式下，统计面板会显示模拟数据：
- 随机生成的总哈希值数量（100-1100）
- 随机生成的总交易量（10,000-1,000,000 wei）
- 模拟的最后更新时间

## 🚀 使用方法

1. 连接钱包和合约
2. 统计面板会自动显示在合约配置区域下方
3. 查看实时统计数据和价格信息
4. 点击刷新按钮手动更新数据

## 🔮 未来扩展

- 历史数据图表
- 导出统计报告
- 自定义时间范围
- 多网络数据对比
- 用户个人统计

---

这个统计面板功能为用户提供了更好的数据洞察，帮助了解合约的使用情况和市场动态。 